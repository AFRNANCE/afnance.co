<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AFRNANCE - African Financial Exchange</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.8.0/web3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(45deg, #00c851, #ffbb33);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            box-shadow: 0 8px 32px rgba(0, 200, 81, 0.3);
        }

        .logo-text {
            font-size: 32px;
            font-weight: bold;
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .tagline {
            color: rgba(255, 255, 255, 0.9);
            font-size: 16px;
            margin-top: 10px;
        }

        .auth-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .auth-form {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 400px;
            backdrop-filter: blur(10px);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-metamask {
            background: linear-gradient(45deg, #f6851b, #e2761b);
            color: white;
        }

        .btn-metamask:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(246, 133, 27, 0.4);
        }

        .main-app {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card h3 {
            margin-bottom: 20px;
            color: #333;
            font-size: 24px;
        }

        .balance-display {
            background: linear-gradient(45deg, #00c851, #00a845);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .crypto-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .crypto-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .crypto-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .crypto-item.selected {
            border-color: #667eea;
            background: #e8f2ff;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn-action {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .btn-receive {
            background: linear-gradient(45deg, #00c851, #00a845);
        }

        .btn-send {
            background: linear-gradient(45deg, #ff4444, #cc3535);
        }

        .btn-withdraw {
            background: linear-gradient(45deg, #ffbb33, #ff8800);
        }

        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .impact-section {
            grid-column: 1 / -1;
            background: linear-gradient(45deg, #00c851, #00a845);
            color: white;
            text-align: center;
            padding: 30px;
            border-radius: 20px;
            margin-top: 20px;
        }

        .impact-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .impact-stat {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
        }

        .savings-groups {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            margin-top: 20px;
        }

        .ubi-claim {
            background: linear-gradient(45deg, #ffbb33, #ff8800);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
        }

        .qr-code {
            text-align: center;
            margin: 20px 0;
        }

        .hidden {
            display: none;
        }

        .kyc-status {
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .kyc-pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .kyc-approved {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .kyc-rejected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        @media (max-width: 768px) {
            .main-app {
                grid-template-columns: 1fr;
            }
            
            .auth-container {
                flex-direction: column;
                align-items: center;
            }
            
            .action-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-icon">AF</div>
                <div class="logo-text">AFRNANCE</div>
            </div>
            <div class="tagline">African Financial Exchange - Crypto to UGX Made Simple</div>
        </header>

        <!-- Authentication Section -->
        <div id="authSection" class="auth-container">
            <div class="auth-form">
                <h3>Sign Up / Login</h3>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="password" placeholder="Enter your password">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="phone" placeholder="+256 XXX XXX XXX">
                </div>
                <button class="btn btn-primary" onclick="handleAuth()">Sign Up / Login</button>
                <button class="btn btn-metamask" onclick="connectMetaMask()">ü¶ä Connect MetaMask</button>
            </div>
        </div>

        <!-- KYC Section -->
        <div id="kycSection" class="auth-container hidden">
            <div class="auth-form">
                <h3>Complete KYC Verification</h3>
                <div id="kycStatus" class="kyc-status kyc-pending">
                    KYC Verification Required
                </div>
                <div class="form-group">
                    <label>National ID Number</label>
                    <input type="text" id="nationalId" placeholder="Enter your National ID">
                </div>
                <div class="form-group">
                    <label>Full Name (as on ID)</label>
                    <input type="text" id="fullName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Date of Birth</label>
                    <input type="date" id="dateOfBirth">
                </div>
                <div class="form-group">
                    <label>District of Residence</label>
                    <select id="district">
                        <option value="">Select District</option>
                        <option value="kampala">Kampala</option>
                        <option value="wakiso">Wakiso</option>
                        <option value="mukono">Mukono</option>
                        <option value="jinja">Jinja</option>
                        <option value="entebbe">Entebbe</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ID Document Upload</label>
                    <input type="file" id="idDocument" accept="image/*,.pdf">
                </div>
                <button class="btn btn-primary" onclick="submitKYC()">Submit KYC</button>
            </div>
        </div>

        <!-- Main Application -->
        <div id="mainApp" class="main-app hidden">
            <!-- Wallet Section -->
            <div class="card">
                <h3>üí≥ Your Wallet</h3>
                <div class="balance-display">
                    <div class="balance-amount" id="ugxBalance">0 UGX</div>
                    <div>Available Balance</div>
                </div>
                
                <div class="crypto-grid">
                    <div class="crypto-item" data-crypto="ETH">
                        <div style="font-size: 24px;">Œû</div>
                        <div>ETH</div>
                        <div id="ethBalance">0.00</div>
                    </div>
                    <div class="crypto-item" data-crypto="USDT">
                        <div style="font-size: 24px;">‚ÇÆ</div>
                        <div>USDT</div>
                        <div id="usdtBalance">0.00</div>
                    </div>
                    <div class="crypto-item" data-crypto="USDC">
                        <div style="font-size: 24px;">‚óã</div>
                        <div>USDC</div>
                        <div id="usdcBalance">0.00</div>
                    </div>
                    <div class="crypto-item" data-crypto="DAI">
                        <div style="font-size: 24px;">‚óà</div>
                        <div>DAI</div>
                        <div id="daiBalance">0.00</div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="btn-action btn-receive" onclick="showReceiveModal()">üì® Receive</button>
                    <button class="btn-action btn-send" onclick="showSendModal()">üì§ Send</button>
                    <button class="btn-action btn-withdraw" onclick="showWithdrawModal()">üí∏ Withdraw</button>
                </div>
            </div>

            <!-- Exchange Section -->
            <div class="card">
                <h3>üîÑ Exchange</h3>
                <div class="form-group">
                    <label>From</label>
                    <select id="fromCurrency">
                        <option value="ETH">Ethereum (ETH)</option>
                        <option value="USDT">Tether (USDT)</option>
                        <option value="USDC">USD Coin (USDC)</option>
                        <option value="DAI">Dai (DAI)</option>
                        <option value="UGX">Ugandan Shilling (UGX)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>To</label>
                    <select id="toCurrency">
                        <option value="UGX">Ugandan Shilling (UGX)</option>
                        <option value="ETH">Ethereum (ETH)</option>
                        <option value="USDT">Tether (USDT)</option>
                        <option value="USDC">USD Coin (USDC)</option>
                        <option value="DAI">Dai (DAI)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount</label>
                    <input type="number" id="exchangeAmount" placeholder="Enter amount" step="0.01">
                </div>
                <div class="form-group">
                    <label>You'll receive (approx.)</label>
                    <input type="text" id="exchangeReceive" readonly>
                </div>
                <button class="btn btn-primary" onclick="performExchange()">üîÑ Exchange Now</button>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <h4>üìä Supported Networks</h4>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px;">
                        <div>üîπ Ethereum</div>
                        <div>üîπ Polygon</div>
                        <div>üîπ Base</div>
                        <div>üîπ Arbitrum</div>
                        <div>üîπ Optimism</div>
                        <div>üîπ Solana</div>
                        <div>üîπ Celo</div>
                        <div>üîπ Metis</div>
                        <div>üîπ Hedera</div>
                    </div>
                </div>
            </div>

            <!-- Impact Section -->
            <div class="impact-section">
                <h3>üåç Environmental & Social Impact</h3>
                <p>1% of platform profits fund environmental restoration and community development</p>
                <div class="impact-stats">
                    <div class="impact-stat">
                        <h4>üå≥ Trees Planted</h4>
                        <div style="font-size: 24px; font-weight: bold;">15,420</div>
                    </div>
                    <div class="impact-stat">
                        <h4>üìö School Supplies Donated</h4>
                        <div style="font-size: 24px; font-weight: bold;">2,850</div>
                    </div>
                    <div class="impact-stat">
                        <h4>‚ôªÔ∏è Plastic Collected (kg)</h4>
                        <div style="font-size: 24px; font-weight: bold;">8,940</div>
                    </div>
                    <div class="impact-stat">
                        <h4>üåæ Wetlands Restored (hectares)</h4>
                        <div style="font-size: 24px; font-weight: bold;">125</div>
                    </div>
                    <div class="impact-stat">
                        <h4>‚òÄÔ∏è Solar Installations</h4>
                        <div style="font-size: 24px; font-weight: bold;">340</div>
                    </div>
                    <div class="impact-stat">
                        <h4>üí∞ UBI Distributed (UGX)</h4>
                        <div style="font-size: 24px; font-weight: bold;">45M</div>
                    </div>
                </div>
            </div>

            <!-- Savings Groups & UBI Section -->
            <div class="savings-groups">
                <div class="ubi-claim">
                    <h4>üí∞ Daily Unconditional Basic Income (UBI)</h4>
                    <p>Rural farmers and women's groups can claim daily $G tokens</p>
                    <button class="btn" style="background: white; color: #ff8800; margin-top: 10px;" onclick="claimUBI()">
                        Claim Today's UBI (500 $G)
                    </button>
                </div>
                
                <h4>üë• Women's Savings Groups</h4>
                <div class="form-group">
                    <label>Weekly Savings Amount (UGX)</label>
                    <input type="number" id="weeklySavings" placeholder="Enter amount">
                </div>
                <div class="form-group">
                    <label>Crypto Allocation (%)</label>
                    <input type="range" id="cryptoAllocation" min="0" max="100" value="20">
                    <div>Current: <span id="cryptoPercentage">20</span>%</div>
                </div>
                <button class="btn btn-primary" onclick="setupSavings()">üí∞ Setup Weekly Savings</button>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="receiveModal" class="modal">
        <div class="modal-content">
            <h3>üì® Receive Crypto</h3>
            <div class="qr-code" id="qrCode"></div>
            <div class="form-group">
                <label>Your Wallet Address</label>
                <input type="text" id="walletAddress" readonly>
                <button onclick="copyAddress()" style="margin-top: 10px; padding: 10px;">üìã Copy Address</button>
            </div>
            <button onclick="closeModal('receiveModal')">Close</button>
        </div>
    </div>

    <div id="sendModal" class="modal">
        <div class="modal-content">
            <h3>üì§ Send Crypto</h3>
            <div class="form-group">
                <label>Recipient Address</label>
                <input type="text" id="sendAddress" placeholder="Enter recipient address">
            </div>
            <div class="form-group">
                <label>Amount</label>
                <input type="number" id="sendAmount" placeholder="Enter amount" step="0.01">
            </div>
            <div class="form-group">
                <label>Currency</label>
                <select id="sendCurrency">
                    <option value="ETH">ETH</option>
                    <option value="USDT">USDT</option>
                    <option value="USDC">USDC</option>
                    <option value="DAI">DAI</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="sendCrypto()">Send</button>
            <button onclick="closeModal('sendModal')">Cancel</button>
        </div>
    </div>

    <div id="withdrawModal" class="modal">
        <div class="modal-content">
            <h3>üí∏ Withdraw to Mobile Money</h3>
            <div class="form-group">
                <label>Mobile Money Provider</label>
                <select id="mobileProvider">
                    <option value="mtn">MTN Mobile Money</option>
                    <option value="airtel">Airtel Money</option>
                </select>
            </div>
            <div class="form-group">
                <label>Phone Number</label>
                <input type="tel" id="withdrawPhone" placeholder="+256 XXX XXX XXX">
            </div>
            <div class="form-group">
                <label>Amount (UGX)</label>
                <input type="number" id="withdrawAmount" placeholder="Enter amount">
            </div>
            <button class="btn btn-primary" onclick="withdrawFunds()">Withdraw</button>
            <button onclick="closeModal('withdrawModal')">Cancel</button>
        </div>
    </div>

    <script>
        // Application State
        let userState = {
            isAuthenticated: false,
            kycCompleted: false,
            kycStatus: 'pending',
            walletAddress: '',
            balances: {
                UGX: 0,
                ETH: 0,
                USDT: 0,
                USDC: 0,
                DAI: 0
            }
        };

        // Exchange rates (mock data)
        const exchangeRates = {
            ETH: 12500000, // 1 ETH = 12.5M UGX
            USDT: 3700,    // 1 USDT = 3,700 UGX
            USDC: 3700,    // 1 USDC = 3,700 UGX
            DAI: 3700      // 1 DAI = 3,700 UGX
        };

        // Initialize the application
        function init() {
            // Generate a mock wallet address
            userState.walletAddress = '0x' + Math.random().toString(16).substr(2, 40);
            
            // Set up event listeners
            document.getElementById('exchangeAmount').addEventListener('input', calculateExchange);
            document.getElementById('fromCurrency').addEventListener('change', calculateExchange);
            document.getElementById('toCurrency').addEventListener('change', calculateExchange);
            document.getElementById('cryptoAllocation').addEventListener('input', updateCryptoPercentage);
        }

        // Authentication
        async function handleAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const phone = document.getElementById('phone').value;

            if (!email || !password || !phone) {
                alert('Please fill in all fields');
                return;
            }

            // Simulate authentication
            userState.isAuthenticated = true;
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('kycSection').classList.remove('hidden');
        }

        // MetaMask Connection
        async function connectMetaMask() {
            if (typeof window.ethereum !== 'undefined') {
                try {
                    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                    userState.walletAddress = accounts[0];
                    userState.isAuthenticated = true;
                    document.getElementById('authSection').classList.add('hidden');
                    document.getElementById('kycSection').classList.remove('hidden');
                    alert('MetaMask connected successfully!');
                } catch (error) {
                    alert('Failed to connect MetaMask: ' + error.message);
                }
            } else {
                alert('MetaMask is not installed. Please install MetaMask to continue.');
            }
        }

        // KYC Submission
        function submitKYC() {
            const nationalId = document.getElementById('nationalId').value;
            const fullName = document.getElementById('fullName').value;
            const dateOfBirth = document.getElementById('dateOfBirth').value;
            const district = document.getElementById('district').value;
            const idDocument = document.getElementById('idDocument').files[0];

            if (!nationalId || !fullName || !dateOfBirth || !district || !idDocument) {
                alert('Please fill in all KYC fields and upload your ID document');
                return;
            }

            // Simulate KYC processing
            document.getElementById('kycStatus').textContent = 'Processing KYC verification...';
            
            setTimeout(() => {
                userState.kycCompleted = true;
                userState.kycStatus = 'approved';
                document.getElementById('kycStatus').textContent = 'KYC Approved ‚úÖ';
                document.getElementById('kycStatus').className = 'kyc-status kyc-approved';
                
                setTimeout(() => {
                    document.getElementById('kycSection').classList.add('hidden');
                    document.getElementById('mainApp').classList.remove('hidden');
                    loadWalletData();
                }, 2000);
            }, 3000);
        }

        // Load wallet data
        function loadWalletData() {
            // Simulate loading balances
            userState.balances = {
                UGX: 2500000,
                ETH: 0.15,
                USDT: 450.00,
                USDC: 320.50,
                DAI: 180.25
            };

            updateBalanceDisplay();
            document.getElementById('walletAddress').value = userState.walletAddress;
        }

        // Update balance display
        function updateBalanceDisplay() {
            document.getElementById('ugxBalance').textContent = 
                new Intl.NumberFormat('en-UG').format(userState.balances.UGX) + ' UGX';
            document.getElementById('ethBalance').textContent = userState.balances.ETH.toFixed(4);
            document.getElementById('usdtBalance').textContent = userState.balances.USDT.toFixed(2);
            document.getElementById('usdcBalance').textContent = userState.balances.USDC.toFixed(2);
            document.getElementById('daiBalance').textContent = userState.balances.DAI.toFixed(2);
        }

        // Exchange calculation
        function calculateExchange() {
            const amount = parseFloat(document.getElementById('exchangeAmount').value) || 0;
            const fromCurrency = document.getElementById('fromCurrency').value;
            const toCurrency = document.getElementById('toCurrency').value;

            if (amount === 0) {
                document.getElementById('exchangeReceive').value = '';
                return;
            }

            let result = 0;

            if (fromCurrency === 'UGX' && toCurrency !== 'UGX') {
                result = amount / exchangeRates[toCurrency];
            } else if (fromCurrency !== 'UGX' && toCurrency === 'UGX') {
                result = amount * exchangeRates[fromCurrency];
            } else if (fromCurrency !== 'UGX' && toCurrency !== 'UGX') {
                const ugxAmount = amount * exchangeRates[fromCurrency];
                result = ugxAmount / exchangeRates[toCurrency];
            } else {
                result = amount;
            }

            document.getElementById('exchangeReceive').value = result.toFixed(6);
        }

        // Perform exchange
        function performExchange() {
            const amount = parseFloat(document.getElementById('exchangeAmount').value);
            const fromCurrency =